Любой, кто, так или иначе, сталкивался с криптографией, знает, что без генераторов случайных чисел в этом деле не обойтись.
Одно из возможных применений таких генераторов, например, – генерация ключей.
Но не каждый при этом задумывается, а насколько «хорош» тот или иной генератор. А если и задумывался, то сталкивался с тем фактом,
что в мире не существует какого-либо единственного «официального» набора критериев, который бы оценивал, насколько данные случайные числа
применимы именно для данной области криптографии. Если последовательность случайных чисел предсказуема, то даже самый стойкий алгоритм шифрования,
в котором данная последовательность будет использоваться, оказывается, уязвим — например, резко уменьшается пространство возможных ключей,
которые необходимо «перебрать» злоумышленнику для получения некоторой информации, с помощью которой он сможет «взломать» всю систему.
К счастью, разные организации все же пытаются навести здесь порядок, в частности, американский институт по стандартам NIST разработал набор
тестов для оценки случайности последовательности чисел.


Правило представляет интерес, потому что оно порождает сложные, во многих отношениях случайные структуры из простых, чётко определенных правил.
При задании различных начальных состояний клеток Правило 30 порождает разные эволюции последующих поколений клеток.
Правило 30 порождает последовательность, кажущуюся во многих отношениях случайной, при начальных условиях, которые нельзя назвать случайными.
Стивен Вольфрам предложил использование вертикальных столбиков в эволюции клеточных автоматов при некоторой заданном начальном состоянии
как псевдослучайную последовательность.
Последовательности, полученные таким способом, удовлетворяют многим стандартным тестам на случайность.

Правило 30 выдает случайные структуры на многих наборах начальных условий. Однако существует и бесконечное количество векторов начальных условий,
порождающих в эволюции периодические структуры. Тривиальный пример — вектор начальных условий, состоящий только из белых клеток (0).
Менее тривиальный пример, найденный Мэтью Куком — любая бесконечная последовательность, состоящая из повторений шаблона 00001000111000,
возможно, разделенных шестью единицами. Ещё больше таких шаблонов было найдено Frans Faase, они представлены здесь.

Вольфрам предположил хаотичность эволюции по Правилу 30, основываясь, в основном, на её внешнем графическом виде.
 Однако позже было показано, что применение Правила 30 удовлетворяет более строгим определениям хаоса, сформулированным Devaney и Knudson.
  В соответствии с критерием Devaney, Правило 30 демонстрирует эффект бабочки — (если задать 2 начальных состояния, различающиеся, например,
  только одним битом, то отдалённые многими поколениями потомки этих 2 состояний будут совершенно различные), периодические конфигурации плотны в
   пространстве всех конфигураций топологии Кантора. Также, Правило 30 обладает свойством перемешивания. В соответствии с критерием Knudson,
   это показывает чувствительность к начальным условиям и плотность орбит процесса (любая конфигурация в итоге приводит к возникновению всех
   возможных конечных конфигураций клеток). Обе этих характеристики хаотичного поведения эволюции по Правилу 30 следуют из свойства Правила 30,
   которое легко проверить: если две конфигурации C и B различаются на одну клетку в позиции i, тогда после одного шага новые конфигурации будут
   различаться в клетке i + 1[5].

I Критерии принятия решения о прохождении теста

Критерий принятия решения на основе задания фиксированного доверительного интервала.
При данном подходе критерий принятия решения формулируется следующим образом: считается, что двоичная последовательность S не проходит
 статистический тест, если значение статистики теста c(S) находится вне пределов доверительного интервала значений статистики,
 вычисленного для заданного уровня значимости.

 В основе тестов лежит понятие нулевой гипотезы. Попробую объяснить, что это. Допустим, мы набрали некую статистическую информацию. Например, пусть это будет количество людей, заболевших раком легких в группе из 1000 человек. И пусть известно, что некоторые люди из этой группы являются курильщиками, а другие нет, причем известно, какие конкретно. Стоит следующая задача: понять, есть ли взаимосвязь между курением и заболеванием. Нулевая гипотеза — это предположение, что между двумя фактами отсутствует какая-либо взаимосвязь. В нашем примере это предположение, что курение не вызывает рак легких. Существует также альтернативная гипотеза, которая опровергает нулевую гипотезу: т.е. между явлениями взаимосвязь существует (курение вызывает рак легких). Если переходить к терминам случайных чисел, то за нулевую гипотезу принимается предположение, что последовательность является истинно случайной (знаки которой появляются равновероятно и независимо друг от друга). Следовательно, если нулевая гипотеза верна, то наш генератор производит достаточно «хорошие» случайные числа.

Как проверяется гипотеза? С одной стороны, мы имеем статистику, подсчитанную на основе фактически собранных данных (т.е. по измеряемой последовательности). С другой стороны, есть эталонная статистика, получаемая математическими методами (теоретически вычисленная), которую бы имела истинно случайная последовательность. Очевидно, что собранная статистика не может сравняться с эталонной — насколько бы ни был хорошо наш генератор, он все равно не идеален. Поэтому вводят некую погрешность, например 5%. Она означает, что если, например, собранная статистика отклоняется от эталонной больше чем на 5%, то делается вывод о том, что нулевая гипотеза не верна с большой надежностью.

Так как мы имеем дело с гипотезами, то существует 4 варианта развития событий:
Сделан вывод о том, что последовательность случайна, и это верный вывод
Сделан вывод о том, что последовательность не случайна, хотя она была на самом деле случайна. Такие ошибки называют ошибками первого рода
Последовательность признана случайной, хотя на самом деле таковой не является. Такие ошибки называют ошибками второго рода
Последовательность справедливо отбракована


Вероятность ошибки первого рода называют уровнем статистической значимости и обозначают как α. Т.е. α — это вероятность отбраковать «хорошую» случайную последовательность. Это значение определяется областью применения. В криптографии принято α брать от 0.001 до 0.01.

В каждом тесте вычисляется т.н. P-значение: это вероятность того, что подопытный генератор произведет последовательность не хуже, чем гипотетический истинный. Если P­значение = 1, то наша последовательность идеально случайна, а если оно = 0, то последовательность полностью предсказуема. В дальнейшем P-значение сравнивается с α, и если она больше α, то нулевая гипотеза принимается и последовательность признается случайной. В противном случае — отбраковывается.

В тестах берется α = 0.01. Из этого следует, что:
Если P-значение ≥ 0.01, то последовательность признается случайной с уровнем доверия 99%
Если P-значение < 0.01, то последовательность отбраковывается с уровнем доверия 99%


Частотный побитовый тест[править | править вики-текст]
Суть данного теста заключается в определении соотношения между нулями и единицами во всей двоичной последовательности. Цель — выяснить,
действительно ли число нулей и единиц в последовательности приблизительно одинаковы, как это можно было бы предположить в случае истинно
 случайной бинарной последовательности. Тест оценивает, насколько близка доля единиц к 0,5. Таким образом, число нулей и единиц должно
 быть примерно одинаковым. Если вычисленное в ходе теста значение вероятности p < 0,01, то данная двоичная последовательность не является
  истинно случайной. В противном случае последовательность носит случайный характер. Стоит отметить, что все последующие тесты проводятся
  при условии, что пройден данный тест.

Частотный блочный тест[править | править вики-текст]
Суть теста — определение доли единиц внутри блока длиной m бит. Цель — выяснить действительно ли частота повторения единиц в блоке длиной
 m бит приблизительно равна m/2, как можно было бы предположить в случае абсолютно случайной последовательности. Вычисленное в ходе теста
 значение вероятности p должно быть не меньше 0,01. В противном случае (p < 0,01) двоичная последовательность не носит истинно случайный
 характер. Если принять m = 1, данный тест переходит в тест № 1 (частотный побитовый тест).

Тест на последовательность одинаковых битов[править | править вики-текст]
Суть состоит в подсчёте полного числа рядов в исходной последовательности, где под словом «ряд» подразумевается непрерывная
подпоследовательность одинаковых битов. Ряд длиной k бит состоит из k абсолютно идентичных битов, начинается и заканчивается с бита, содержащего
противоположное значение. Цель данного теста — сделать вывод о том, действительно ли количество рядов, состоящих из единиц и нулей с различными
длинами, соответствует их количеству в случайной последовательности. В частности, определяется быстро либо медленно чередуются единицы и нули в
исходной последовательности. Если вычисленное в ходе теста значение вероятности p < 0,01, то данная двоичная последовательность не является истинно
 случайной. В противном случае она носит случайный характер.

Тест на самую длинную последовательность единиц в блоке[править | править вики-текст]
В данном тесте определяется самый длинный ряд единиц внутри блока длиной m бит. Цель — выяснить действительно ли длина такого ряда соответствует ожиданиям длины самого протяжённого ряда единиц в случае абсолютно случайной последовательности. Если высчитанное в ходе теста значение вероятности p < 0,01 полагается, что исходная последовательность не является случайной. В противном случае делается вывод о её случайности. Следует заметить, что из предположения о примерно одинаковой частоте появления единиц и нулей (тест № 1) следует, что точно такие же результаты данного теста будут получены при рассмотрении самого длинного ряда нулей. Поэтому измерения можно проводить только с единицами.

Тест рангов бинарных матриц[править | править вики-текст]
Здесь производится расчёт рангов непересекающихся подматриц, построенных из исходной двоичной последовательности. Целью этого теста является
проверка на линейную зависимость подстрок фиксированной длины, составляющих первоначальную последовательность. В случае если вычисленное в ходе теста значение вероятности p < 0,01, делается вывод о неслучайном характере входной последовательности бит. В противном случае считаем её абсолютно случайной. Данный тест так же присутствует в пакете DIEHARD.

Спектральный тест[править | править вики-текст]

Спектральный тест
Суть теста заключается в оценке высоты пиков дискретного преобразования Фурье исходной последовательности. Цель — выявление периодических
свойств входной последовательности, например, близко расположенных друг к другу повторяющихся участков. Тем самым это явно демонстрирует
отклонения от случайного характера исследуемой последовательности. Идея состоит в том, чтобы число пиков, превышающих пороговое значение в 95 % по
амплитуде, было значительно больше 5 %. Если вычисленное в ходе теста значение вероятности p < 0,01, то данная двоичная последовательность
не является абсолютно случайной. В противном случае она носит случайный характер.

Тест на совпадение неперекрывающихся шаблонов[править | править вики-текст]
В данном тесте подсчитывается количество заранее определенных шаблонов, найденных в исходной последовательности. Цель — выявить генераторы случайных
или псевдослучайных чисел, формирующие слишком часто заданные непериодические шаблоны. Как и в тесте № 8 на совпадение перекрывающихся шаблонов
для поиска конкретных шаблонов длиной m бит используется окно также длиной m бит. Если шаблон не обнаружен, окно смещается на один бит. Если же
 шаблон найден, окно перемещается на бит, следующий за найденным шаблоном, и поиск продолжается дальше. Вычисленное в ходе теста значение вероятности
  p должно быть не меньше 0,01. В противном случае (p < 0,01), двоичная последовательность не является абсолютно случайной.

Тест на совпадение перекрывающихся шаблонов[править | править вики-текст]
Суть данного теста заключается в подсчете количества заранее определенных шаблонов, найденных в исходной последовательности. Как и в тесте № 7 на
совпадение неперекрывающихся шаблонов для поиска конкретных шаблонов длиной m бит используется окно также длиной m бит. Сам поиск производится
 аналогичным образом. Если шаблон не обнаружен, окно смещается на один бит. Разница между этим тестом и тестом № 7 заключается лишь в том, что если
  шаблон найден, окно перемещается только на бит вперед, после чего поиск продолжается дальше. Вычисленное в ходе теста значение вероятности p
  должно быть не меньше 0,01. В противном случае (p < 0,01), двоичная последовательность не является абсолютно случайной.

Универсальный статистический тест Маурера[править | править вики-текст]
Здесь определяется число бит между одинаковыми шаблонами в исходной последовательности (мера, имеющая непосредственное отношение к длине сжатой
последовательности). Цель теста — выяснить может ли данная последовательность быть значительно сжата без потерь информации. В случае если это
 возможно сделать, то она не является истинно случайной. В ходе теста вычисляется значение вероятности p. Если p < 0,01, то полагается, что
 исходная последовательность не является случайной. В противном случае делается вывод о её случайности.

Тест на линейную сложность[править | править вики-текст]
В основе теста лежит принцип работы линейного регистра сдвига с обратной связью (англ. Linear Feedback Shift Register, LFSR).
Цель — выяснить является ли входная последовательность достаточно сложной для того, чтобы считаться абсолютно случайной.
Абсолютно случайные последовательности характеризуются длинными линейными регистрами сдвига с обратной связью. Если же такой регистр слишком
короткий, то предполагается, что последовательность не является в полной мере случайной. В ходе теста вычисляется значение вероятности p.
 Если p < 0,01, то полагается, что исходная последовательность не является случайной. В противном случае делается вывод о её случайности.

Тест на периодичность[править | править вики-текст]
Данный тест заключается в подсчете частоты всех возможных перекрываний шаблонов длины m бит на протяжении исходной последовательности битов.
Целью является определение действительно ли количество появлений 2m перекрывающихся шаблонов длиной m бит, приблизительно такое же как в случае
абсолютно случайной входной последовательности бит. Последняя, как известно, обладает однообразностью, то есть каждый шаблон длиной m бит
 появляется в последовательности с одинаковой вероятностью. Если вычисленное в ходе теста значение вероятности p < 0,01, то данная двоичная
 последовательность не является абсолютно случайной. В противном случае, она носит случайный характер. Стоит отметить, что при m=1 тест на
 периодичность переходит в частотный побитовый тест (№ 1).

Тест приблизительной энтропии[править | править вики-текст]
Как и в тесте на периодичность в данном тесте акцент делается на подсчёте частоты всех возможных перекрываний шаблонов длины m бит на протяжении
исходной последовательности битов. Цель теста — сравнить частоты перекрывания двух последовательных блоков исходной последовательности с длинами
m и m+1 с частотами перекрывания аналогичных блоков в абсолютно случайной последовательности. Вычисляемое в ходе теста значение вероятности p должно
быть не меньше 0,01. В противном случае (p < 0,01), двоичная последовательность не является абсолютно случайной.

Тест кумулятивных сумм[править | править вики-текст]
Тест заключается в максимальном отклонении (от нуля) при произвольном обходе, определяемым кумулятивной суммой заданных (-1, +1) цифр в
последовательности. Цель данного теста — определить является ли кумулятивная сумма частичных последовательностей, возникающих во входной
оследовательности, слишком большой или слишком маленькой по сравнению с ожидаемым поведением такой суммы для абсолютно случайной входной
последовательности. Таким образом, кумулятивная сумма может рассматриваться как произвольный обход. Для случайной последовательности отклонения от
 произвольного обхода должны быть вблизи нуля. Для некоторых типов последовательностей, не являющихся в полной мере случайными подобные отклонения
 от нуля при произвольном обходе будут достаточно существенными. Если вычисленное в ходе теста значение вероятности p < 0,01, то входная двоичная
 последовательность не является абсолютно случайной. В противном случае она носит случайный характер.

Тест на произвольные отклонения[править | править вики-текст]
Суть данного теста заключается в подсчёте числа циклов, имеющих строго k посещений при произвольном обходе кумулятивной суммы.
Произвольный обход кумулятивной суммы начинается с частичных сумм после последовательности (0,1), переведённой в соответствующую последовательность
(-1, +1). Цикл произвольного обхода состоит из серии шагов единичной длины, совершаемых в случайном порядке.
 Кроме того такой обход начинается и заканчивается на одном и том же элементе. Цель данного теста — определить отличается ли число посещений
 определенного состояния внутри цикла от аналогичного числа в случае абсолютно случайной входной последовательности. Фактически данный тест есть набор,
  состоящий из восьми тестов, проводимых для каждого из восьми состояний цикла: −4, −3, −2, −1 и +1, +2, +3, +4.
  В каждом таком тесте принимается решение о степени случайности исходной последовательности в соответствии со следующим правилом:
  если вычисленное в ходе теста значение вероятности p < 0,01, то входная двоичная последовательность не является абсолютно случайной.
  В противном случае она носит случайный характер.
